# Simple proxy handler, used by the front-end RESTBase to proxy requests to
# the AQS backend. Pulled in by projects/wikimedia.org.yaml.

paths:
  /per-article/{+rest}:
    get:
      x-request-handler:
        - get_from_backend:
            request:
              uri: '{{options.host}}/pageviews/per-article/{+rest}'
            return:
              status: '{{get_from_backend.status}}'
              headers: '{{merge({"cache-control":"s-maxage=3600, max-age=3600"}, get_from_backend.headers)}}'
              body: '{{get_from_backend.body}}'

  /per-project/{+rest}:
    get:
      x-request-handler:
        - get_from_backend:
            request:
              uri: '{{options.host}}/pageviews/aggregate/{+rest}'
            return:
              status: '{{get_from_backend.status}}'
              headers: '{{merge({"cache-control":"s-maxage=3600, max-age=3600"}, get_from_backend.headers)}}'
              body: '{{get_from_backend.body}}'

  /top/{+rest}:
    get:
      x-request-handler:
        - get_from_backend:
            request:
              uri: '{{options.host}}/pageviews/top/{+rest}'
            return:
              status: '{{get_from_backend.status}}'
              headers: '{{merge({"cache-control":"s-maxage=3600, max-age=3600"}, get_from_backend.headers)}}'
              body: '{{get_from_backend.body}}'
